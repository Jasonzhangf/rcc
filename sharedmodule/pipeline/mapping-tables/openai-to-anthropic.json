{
  "version": "1.0.0",
  "description": "OpenAI to Anthropic protocol conversion",
  "protocols": {
    "input": "openai",
    "output": "anthropic"
  },
  "requestMappings": {
    "model": {
      "field": "model",
      "transform": "mapOpenAIModelToAnthropic"
    },
    "max_tokens": {
      "field": "max_tokens"
    },
    "messages": {
      "field": "messages",
      "transform": "convertOpenAIMessagesToAnthropic"
    },
    "temperature": {
      "field": "temperature"
    },
    "top_p": {
      "field": "top_p"
    },
    "stop": {
      "field": "stop_sequences",
      "transform": "convertStopToArray"
    },
    "stream": {
      "field": "stream"
    }
  },
  "responseMappings": {
    "choices[0].message.content": {
      "field": "content"
    },
    "choices[0].message.role": {
      "field": "role"
    },
    "usage.prompt_tokens": {
      "field": "usage.input_tokens"
    },
    "usage.completion_tokens": {
      "field": "usage.output_tokens"
    },
    "id": {
      "field": "id"
    }
  },
  "validation": {
    "required": ["model", "messages"],
    "types": {
      "model": "string",
      "messages": "array",
      "max_tokens": "number",
      "temperature": "number",
      "top_p": "number"
    },
    "ranges": {
      "temperature": { "min": 0, "max": 2 },
      "top_p": { "min": 0, "max": 1 },
      "max_tokens": { "min": 1, "max": 200000 }
    }
  },
  "transformFunctions": {
    "mapOpenAIModelToAnthropic": {
      "type": "mapping",
      "mappings": {
        "gpt-4": "claude-3-opus-20240229",
        "gpt-4-turbo": "claude-3-sonnet-20240229",
        "gpt-3.5-turbo": "claude-3-haiku-20240307"
      },
      "defaultValue": "claude-3-sonnet-20240229"
    },
    "convertOpenAIMessagesToAnthropic": {
      "type": "array_transform",
      "elementTransform": {
        "role": {
          "mapping": {
            "user": "user",
            "assistant": "assistant"
          }
        },
        "content": {
          "field": "content"
        }
      }
    },
    "convertStopToArray": {
      "type": "transform",
      "operation": "stringToArray"
    }
  }
}